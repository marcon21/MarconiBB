{% extends "base.html" %}

{% block page_head %}

<nav>
    <div class="nav-wrapper amber darken-1">
        <a href="" class="brand-logo center">{{ page.title }}</a>
    </div>
</nav>

{% endblock page_head %}


{% block page_content %}

<h4 class="center">Scegli il giorno da prenotare!</h4>

<div class="row">
    <div class='col s3 m3 l3'></div>
    <div class="col s6 m6 l6">
        <ul class='collection'>
            {% for day in page.days %}
            <li id="{{ loop.index }}" class='collection-item avatar user-content selection'>
                <i class="large material-icons circle amber darken-1">today</i>
                <span class="title">{{ day.name }}</span>
                <span class="title">{{ day.daySpelled }}</span>
                <span class="title">{{ day.day }}</span>
                <span class="title">{{ day.month }}</span>
            </li>
            {% endfor %}
        </ul>
    </div>
</div>


<script type="text/javascript" charset="utf-8">
    var socket = io.connect('http://' + document.domain + ':' + location.port);

    var day = 1;
    var n = document.getElementsByTagName("li").length + 1;

    changeActiveStatus();

    socket.on('next', function (data) {
        console.log("next");
        day = day % (n - 1) + 1;
        changeActiveStatus();
    });

    socket.on('changePage', function (data) {
        console.log(document.getElementById(String(day)));
        socket.emit("daySelected", {
            dayIndex: day - 1
        });
        window.location.replace("/hour");
    });

    socket.on('refresh', function (data) {
        window.location.reload(1);
    });

    function changeActiveStatus() {
        // console.log(document.getElementById(String(1)))
        for (let i = 1; i < n; i++) {
            if (i == day) {
                document.getElementById(String(i)).classList.add('selection');
            } else {
                document.getElementById(String(i)).classList.remove('selection');
            }
        }
    }
</script>

{% endblock page_content %}